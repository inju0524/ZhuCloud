<!DOCTYPE html>
<html lang="<!--constStr@language-->">
	<head>
		<meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta name="keywords" content="<!--Keywords-->">
        <meta name="description" content="<!--Description-->">
        <link rel="icon" href="<!--base_path-->favicon.ico" type="image/x-icon">
        <link rel="shortcut icon" href="<!--base_path-->favicon.ico" type="image/x-icon">
        
        <title><!--Title--></title>


        <!--MdRequireStart-->
            <link rel="stylesheet" href="https://charo.koto.cc/aom-assets/depends/marked/github-markdown.css">
            <script src="https://charo.koto.cc/aom-assets/depends/marked/marked.js"></script>
        <!--MdRequireEnd-->
        <!--GuestUploadStart--><script type="text/javascript" src="?jsFile=spark-md5.min.js"></script><!--GuestUploadEnd-->
    <!--AliyundriveUploadJsStart--><script src="https://unpkg.com/bignumber.js@9.0.2/bignumber.js"></script><script src="?jsFile=sha1.min.js"></script><!--AliyundriveUploadJsEnd-->

        <!--customCss-->
	<link rel="stylesheet" href="https://charo.koto.cc/aom-assets/_astro/allinone.43fc9617.css" />
<link rel="stylesheet" href="https://charo.koto.cc/aom-assets/_astro/allinone.11a782e3.css" /><script type="module" src="https://charo.koto.cc/aom-assets/_astro/hoisted.d9ceb923.js"></script><script nomodule src="https://charo.koto.cc/aom-assets/s.6.14.1.min.js"></script><script nomodule src="https://charo.koto.cc/aom-assets/_astro/MultiDisk-legacy.a36c04d2.js"></script><script nomodule src="https://charo.koto.cc/aom-assets/_astro/hoisted-legacy.dc9c781c.js"></script><script nomodule src="https://charo.koto.cc/aom-assets/_astro/hoisted-legacy.fd96d87d.js"></script>

<style>
        
#upload_file_bu:active{transform: scale(1.01);}
        #upload_file{
            
            opacity: 0;
            position: absolute;
            width: 100%;
            height: 100%;
            left: 0;
            top: 0;
                display: inline-block;

            
            
        }
        #upload_file:not([data-disabled="true"]):hover {
    -webkit-transform: scale(1.05);
    -ms-transform: scale(1.05);
    transform: scale(1.05);
    box-shadow: #6a6a6a 1spx 1px 20px;
}
        #upload_file_bu{
  
    

    width: aoto;
    -webkit-transition: all .35s ease-in-out;
    -webkit-transition: all .35s ease;
    transition: all .35s ease;
    background-color: #80808080;
    border-radius: 16px;
    padding: 10px 12px;
    min-width: 0;
    min-height: 40px;
    box-sizing: border-box;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    appearance: auto;
    user-select: none;
    white-space-collapse: preserve;
    text-wrap: nowrap;
    align-items: flex-start;
    text-align: center;
    cursor: default;
    box-sizing: border-box;
    background-color: buttonface;
    color: buttontext;
    padding-block: 1px;
    padding-inline: 6px;
    border-width: 2px;
    border-style: outset;
    border-color: buttonborder;
    border-image: initial;
    background-color: #80808080;
        }
        #upload_btns{

        }
</style>

</head>
	<body>
		<header>
	<span class="left">
	<span onclick="SideBar.Open()" title="Open Sidebar.">
			<svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:bars-3"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75zM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75z" clip-rule="evenodd"/></svg>
			<!-- <Menu /> -->
		</span>
		<span onclick="MultiDisk.Expand()" title="Open multi disk controller">
			<span class="ExpandIcon" data-ControllerHidden="true"><svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:chevron-down"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5z" clip-rule="evenodd"/></svg></span>
		</span>
		
	</span>

    <div class="Header">

		<a class="title" href="/">
			<img src="<!--base_path-->favicon.ico" alt="">
			<span><!--Sitename--></span>
    	</a>
		
		<span class="CurrentDriveName" onclick="MultiDisk.Expand();">
			<span id="DriveName">(CurrentDriveName)</span>
			<span class="ExpandIcon" data-ControllerHidden="true"><svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:chevron-down"><path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5z" clip-rule="evenodd"/></svg></span>
		</span>

    </div>

	<span class="right">
		<span onclick="ThemeSwitcher.Switch();" title="Switch theme, light or dark">
			<span class="ThemeSwitcher astro-PLNBXQHS">
    <span id="MoonIcon" style="display: inline-block;" class="astro-PLNBXQHS">
        <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-PLNBXQHS" astro-icon="heroicons:moon"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162z" clip-rule="evenodd"/></svg>
    </span>
    <span id="SunIcon" style="display: none;" class="astro-PLNBXQHS">
        <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-PLNBXQHS" astro-icon="heroicons:sun"><path d="M12 2.25a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0V3a.75.75 0 0 1 .75-.75zM7.5 12a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0zm11.394-5.834a.75.75 0 0 0-1.06-1.06l-1.591 1.59a.75.75 0 1 0 1.06 1.061l1.591-1.59zM21.75 12a.75.75 0 0 1-.75.75h-2.25a.75.75 0 0 1 0-1.5H21a.75.75 0 0 1 .75.75zm-3.916 6.894a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 1 0-1.061 1.06l1.59 1.591zM12 18a.75.75 0 0 1 .75.75V21a.75.75 0 0 1-1.5 0v-2.25A.75.75 0 0 1 12 18zm-4.242-.697a.75.75 0 0 0-1.061-1.06l-1.591 1.59a.75.75 0 0 0 1.06 1.061l1.591-1.59zM6 12a.75.75 0 0 1-.75.75H3a.75.75 0 0 1 0-1.5h2.25A.75.75 0 0 1 6 12zm.697-4.243a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 0 0-1.061 1.06l1.59 1.591z"/></svg>
    </span>
</span>
		</span>
		<span onclick="location.assign('/?login=admin')" title="Login">
			<svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:arrow-right-on-rectangle"><path fill-rule="evenodd" d="M7.5 3.75A1.5 1.5 0 0 0 6 5.25v13.5a1.5 1.5 0 0 0 1.5 1.5h6a1.5 1.5 0 0 0 1.5-1.5V15a.75.75 0 0 1 1.5 0v3.75a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V5.25a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3V9A.75.75 0 0 1 15 9V5.25a1.5 1.5 0 0 0-1.5-1.5h-6zm10.72 4.72a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1 0 1.06l-3 3a.75.75 0 1 1-1.06-1.06l1.72-1.72H9a.75.75 0 0 1 0-1.5h10.94l-1.72-1.72a.75.75 0 0 1 0-1.06z" clip-rule="evenodd"/></svg>
		</span>
	</span>
</header>

<!--MultiDiskAreaStart-->
<div class="MultiDiskContainer hidden astro-H4YAVCU5" id="more-disk-div">
    <div class="MultiDisk astro-H4YAVCU5">
        <!--MultiDisksStart-->
            <a href="<!--MultiDisksUrl-->" class="Disk <!--MultiDisksNow--> astro-H4YAVCU5" aria-label="A disk">
                <!--MultiDisksName-->
            </a>
        <!--MultiDisksEnd-->
    </div>
</div>
<!--MultiDiskAreaEnd-->
		<main>
		
<!-- 加密文件夹 -->
<!--EncryptedStart-->
            <div class="Contents" id="imgFil-div" style="padding: 15px 30px; font-size: larger; font-weight: bold;">
                加密文件夹
            </div>
            <div class="Contents" id="need—pw-div" style="padding: 50px 30px; font-size: larger; font-weight: bold;">
                <center>
                    <form action="" method="post">
                    <input class="code" id="password1" name="password1" type="password" placeholder="请输入文件夹密码">
                    <br>
                    <input class="UglyButton astro-5BUYZ7RE" type="submit" value="确认">
                    </form>
                </center>
            </div>
<!--EncryptedEnd-->

	

<!-- 游客上传 -->
<!--GuestUploadStart-->
            <div class="Contents" id="imgFil-div" style="padding: 15px 30px; font-size: larger; font-weight: bold;">
                文件上传
            </div>

            <div class="Contents" id="imgFil-div" style="padding: 15px 30px; font-size: larger; font-weight: bold;">
                <div id="upload_div">
                                        <div class="Contents" id="upload_file_bu">上传文件<input class="Contents" id="upload_file" type="file" name="upload_filename" multiple="multiple"></div>
                    <div id="upload_btns" align="center">
                        <select class="UglyButton astro-5BUYZ7RE" onchange="document.getElementById('upload_file').webkitdirectory=this.value;">
                            <option value="">文件</option>
                            <option value="1">文件夹</option>
                        </select>

                        <input class="UglyButton astro-5BUYZ7RE" id="upload_submit" onclick="preup();" value="上传" type="button">
                    </div>
                </div>
            </div>
<!--GuestUploadEnd-->

		    <!--HeadomfStart-->
		        <div class="Contents">
                    <div class="customfile" id="head-om">
                        <!--HeadomfContent-->
                    </div>
		        </div>
            <!--HeadomfEnd-->

            <!--HeadmdStart-->
		        <div class="Contents">
                    <div class="markdown-body" id="head">
                        <textarea id="head-md" style="display:none;"><!--HeadmdContent--></textarea>
                    </div>

                    
                </div>
            <!--HeadmdEnd-->
            


            <div class="Contents">
                <div>
                    
                    <div style="display: flex; align-items: center;">
    <a class="UglyButton astro-5BUYZ7RE" href="<!--base_path-->" data-disabled="undefined">
    <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:home"><path d="M11.47 3.84a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.06l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 0 0 1.061 1.06l8.69-8.69z"/><path d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.43z"/></svg>
</a>
    
    <!--DiskPathArrayStart-->
    
    <span class="UglyIcon astro-27M7QWAL">
    <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:chevron-right"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5z" clip-rule="evenodd"/></svg>
</span>
    
    <a class="UglyButton astro-5BUYZ7RE" href="<!--PathArrayLink-->" data-disabled="undefined">
    
        <!--PathArrayName-->
    
</a>
    
    <!--DiskPathArrayEnd-->
</div>

                    <div class="Divider astro-233M6D5J"></div>

                    <h3><!--constStr@File--></h3>

                    <!--IsFolderStart-->
                        <div class="FolderDesc astro-QZ24M4LY" id="<!--FolderId-->">
    <div class="FileName astro-QZ24M4LY">
        <!--constStr@File-->
    </div>
    <div style="width: 20%;text-align: right;" class="EditTime astro-QZ24M4LY">
        <!--constStr@EditTime-->
    </div>
    <div style="width: 20%;text-align: right;" class="Size astro-QZ24M4LY">
        <!--constStr@Size-->
    </div>
</div>



<!--FolderListStart-->
<div id="Folders" class="astro-QZ24M4LY">
    <a class="UglyLink astro-ZMKMY7GO" href="<!--FileEncodeReplaceUrl-->/">
    <div class="ListItems astro-QZ24M4LY">
            <div data-FileId="<!--FileId-->" class="astro-QZ24M4LY">
                <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-QZ24M4LY" astro-icon="heroicons:folder"><path d="M19.5 21a3 3 0 0 0 3-3v-4.5a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3V18a3 3 0 0 0 3 3h15zm-18-10.854V6a3 3 0 0 1 3-3h5.379a2.25 2.25 0 0 1 1.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 0 1 3 3v1.146A4.483 4.483 0 0 0 19.5 9h-15a4.483 4.483 0 0 0-3 1.146z"/></svg>
                <!--FileEncodeReplaceName-->
            </div>
            <div class="astro-QZ24M4LY">
                <!--lastModifiedDateTime-->
            </div>
            <div class="astro-QZ24M4LY">
                <!--size-->
            </div>
        </div>
</a>
</div>
<!--FolderListEnd-->

<!--FileListStart-->
<div id="Files" class="astro-QZ24M4LY">
    <a class="UglyLink astro-ZMKMY7GO" href="<!--FileEncodeReplaceUrl-->?preview">
    <div class="ListItems astro-QZ24M4LY">
            <div data-FileId="<!--FileId-->" class="astro-QZ24M4LY">
                <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-QZ24M4LY" astro-icon="heroicons:document"><path d="M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625z"/><path d="M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963z"/></svg>
                <!--FileEncodeReplaceName-->
            </div>
            <div class="astro-QZ24M4LY">
                <!--lastModifiedDateTime-->
            </div>
            <div class="astro-QZ24M4LY">
                <!--size-->
            </div>
        </div>
</a>
</div>
<!--FileListEnd-->

<!--MorePageStart-->
<form class="MorePage astro-R62JC56R" action="" method="POST" id="nextpageform">
    <input type="hidden" id="pagenum" name="pagenum" value="" class="astro-R62JC56R">

    <div class="astro-R62JC56R">
        <div class="astro-R62JC56R">
            <!--PrePageStart-->
            <a class="UglyButton astro-5BUYZ7RE" onclick="nextpage(<!--PrePageNum-->);" data-disabled="undefined">
    <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-R62JC56R" astro-icon="heroicons:arrow-left"><path fill-rule="evenodd" d="M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0z" clip-rule="evenodd"/></svg>
</a>
            <!--PrePageEnd-->
        </div>
        <div class="updated_at astro-R62JC56R">
            <!--MorePageListStart-->
                <a onclick="nextpage(<!--PageNum-->);" class="astro-R62JC56R"><!--PageNum--></a>
            <!--MorePageListEnd-->
            
            <!--MorePageListNowStart-->
                <a style="font-size: larger;" class="astro-R62JC56R"><!--PageNum--></a>
            <!--MorePageListNowEnd-->
    </div>
        <div class="astro-R62JC56R">
            <!--NextPageStart-->
            <a class="UglyButton astro-5BUYZ7RE" onclick="nextpage(<!--NextPageNum-->);" data-disabled="undefined">
    <svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" class="astro-R62JC56R" astro-icon="heroicons:arrow-right"><path fill-rule="evenodd" d="M12.97 3.97a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 1 1-1.06-1.06l6.22-6.22H3a.75.75 0 0 1 0-1.5h16.19l-6.22-6.22a.75.75 0 0 1 0-1.06z" clip-rule="evenodd"/></svg>
</a>
            <!--NextPageEnd-->
        </div>
    </div>
</form>


<script>
function nextpage(num) {
    document.getElementById('pagenum').value=num;
    document.getElementById('nextpageform').submit();
}
</script>
<!--MorePageEnd-->
                    <!--IsFolderEnd-->

                    <!--IsFileStart-->
                        <div style="text-align: center; width=90%;margin: 0 auto; padding: 15px 5px;">

    <!--IsOtherFileStart-->
    <p><!--constStr@FileNotSupport--></p>
    <!--IsOtherFileEnd-->

    <code id="url" title="url">
        <!--FileEncodeUrl-->
    </code>
    <a class="UglyButton astro-5BUYZ7RE" href="<!--FileEncodeUrl-->" data-disabled="undefined">
    <span><svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:arrow-down-tray"><path fill-rule="evenodd" d="M12 2.25a.75.75 0 0 1 .75.75v11.69l3.22-3.22a.75.75 0 1 1 1.06 1.06l-4.5 4.5a.75.75 0 0 1-1.06 0l-4.5-4.5a.75.75 0 1 1 1.06-1.06l3.22 3.22V3a.75.75 0 0 1 .75-.75zm-9 13.5a.75.75 0 0 1 .75.75v2.25a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5V16.5a.75.75 0 0 1 1.5 0v2.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V16.5a.75.75 0 0 1 .75-.75z" clip-rule="evenodd"/></svg>&nbsp;<!--constStr@Download--></span>
</a>
    <a class="UglyButton astro-5BUYZ7RE" href="<!--FileEncodeUrl-->" data-disabled="undefined">
    <span><svg fill="currentColor" aria-hidden="true" viewBox="0 0 24 24" astro-icon="heroicons:document-duplicate"><path d="M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.161 14.34 9 15.375 9h1.875A3.75 3.75 0 0 1 21 12.75v3.375C21 17.16 20.16 18 19.125 18h-9.75A1.875 1.875 0 0 1 7.5 16.125V3.375z"/><path d="M15 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 17.25 7.5h-1.875A.375.375 0 0 1 15 7.125V5.25zM4.875 6H6v10.125A3.375 3.375 0 0 0 9.375 19.5H16.5v1.125c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V7.875C3 6.839 3.84 6 4.875 6z"/></svg>&nbsp;Copy URL</span>
</a>
    <script>
        var $url = document.getElementById("url");
        if ($url) {
            $url.innerHTML = location.href.replace(/\?preview$/gi, "").replace(/&amp;/g, "&amp;amp;");
        }
    </script>



    <!--IstxtFileStart-->
        <textarea class="code" id="txt-render" readonly>            <!--TxtContent-->
        </textarea>
        <script>
            document.getElementById("txt-render").style.height = $textarea.scrollHeight + "px";
        </script>
    <!--IstxtFileEnd-->


    <!--IsimgFileStart-->
    <br>
    <img src="<!--FileEncodeUrl-->" alt="<!--FileName-->" style="margin: 10px 0;" onload="
            if (this.offsetWidth>document.getElementById('url').offsetWidth) this.style.width='100%';
            if (this.offsetHeight>document.documentElement.clientHeight) this.style.height=document.documentElement.clientHeight + 'px';
        ">
    <!--IsimgFileEnd-->


    <!--IsvideoFileStart-->
        <div id="dplayer-video" style="margin: 10px 0;" data-src="<!--FileEncodeUrl-->"></div>
        <script src="https://charo.koto.cc/aom-assets/DPlayer/DPlayer.min.js"></script>
        <script>
            const DPlayerObject = new DPlayer({
                container: document.getElementById("dplayer-video"),
                video: {
                    url: document.getElementById("dplayer-video").getAttribute("data-src"),
                },
            });

        </script>
    <!--IsvideoFileEnd-->


    <!--IsmusicFileStart-->
        <audio src="<!--FileDownUrl-->" controls="controls" style="width: 100%;margin: 10px 0;"></audio>
    <!--IsmusicFileEnd-->


    <!--IsofficeFileStart-->
        <iframe style="margin: 10px 0; border: none; width: 100%; height: 800px" id="office-render" src="https://view.officeapps.live.com/op/view.aspx?src=<!--FileEncodeDownUrl-->"></iframe>
    <!--IsofficeFileEnd-->



    <!--IspdfFileStart-->
        <div id="pdf-render">Loading PDF</div>
        <script src="https://charo.koto.cc/aom-assets/PDF/pdf.min.js"></script>
        <script>
            pdfjsLib.GlobalWorkerOptions.workerSrc = "https://charo.koto.cc/aom-assets/PDF/pdf.worker.min.js";
            var loadingTask = pdfjsLib.getDocument({
                url: "<!--FileDownUrl-->",
                disableStream: true,
                disableAutoFetch: true,
                rangeChunkSize: 65535
            });
            loadingTask.promise.then(function(pdf) {
                var pdfContainer = document.getElementById('pdf-render');
                pdfContainer.innerHTML = '';
                var pagenum =  pdf.numPages;
                var pagepos = 1;
                var pdfnextpagebutton = document.createElement('button');
                pdfnextpagebutton.id = 'pdfnextpagebutton';
                pdfnextpagebutton.innerText = 'Load page ' + pagepos + '-' + (pagepos+4<pagenum?pagepos+4:pagenum) + ' (' + pagenum + ')';
                pdfnextpagebutton.setAttribute('onclick', "this.style.display = 'none';");
                pdfnextpagebutton.style.display = 'none';
                pdfContainer.appendChild(pdfnextpagebutton);
                var pdfWaitNextPage = setInterval(function(){
                    if (pdfnextpagebutton.style.display==='none') {
                        for (var i=pagepos;i<=(pagepos+4<pagenum?pagepos+4:pagenum);i++) {
                            var canvasNew = document.createElement('canvas');
                            canvasNew.id = 'pdf-c'+i;
                            pdfContainer.appendChild(canvasNew);
                            renderpage(pdf,i);
                        }
                        pagepos = i;
                        if (pagepos<pagenum) {
                            console.log("next page: " + pagepos + " / " + pagenum);
                            pdfnextpagebutton.innerText = 'Load page ' + pagepos + '-' + (pagepos+4<pagenum?pagepos+4:pagenum) + ' (' + pagenum + ')';
                            pdfnextpagebutton.style.display ='';
                            pdfContainer.appendChild(pdfnextpagebutton);
                        } else {
                            console.log("end of pdf");
                            clearInterval(pdfWaitNextPage);
                        }
                    }
                }, 1000);
            });
            function renderpage(pdf,i) {
                pdf.getPage(i).then(function(page) { 
                    var scale = 1.5;
                    var viewport = page.getViewport({ scale: scale, });
                    var canvas = document.getElementById('pdf-c'+i);
                    var context = canvas.getContext("2d");
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;
                    var renderContext = {
                        canvasContext: context,
                        viewport: viewport,
                    };
                    page.render(renderContext);
                });
            }
        </script>
    <!--IspdfFileEnd-->

</div>

<style>
    #pdf-render {
        box-sizing: border-box;
        max-width: 100%;
        height: 75vh;
        overflow: auto;
    }
    #pdf-render canvas {
        width: 100%;
    }
</style>
                    <!--IsFileEnd-->

                </div>
            </div>
            


            <!--ReadmemdStart-->
		        <div class="Contents">
                    <div class="markdown-body" id="readme">
                        <textarea id="readme-md" style="display:none;"><!--ReadmemdContent--></textarea>
                    </div>

                    
                </div>
            <!--ReadmemdEnd-->
            <!--FootomfStart-->
		        <div class="Contents">
                    <div class="customfile" id="foot-om">
                        <!--FootomfContent-->
                    </div>
		        </div>
            <!--FootomfEnd-->
		</main>
        <div class="astro-55HNOTDJ">
    <p style="font-size: larger;" class="astro-55HNOTDJ"></p>
    <p class="astro-55HNOTDJ">
        Powered by
        <a href="https://astro.build/" class="astro-55HNOTDJ">INJU银烛</a>&nbsp;|&nbsp;
        Theme for
        <a href="https://github.com/qkqpttgf/OneManager-php" class="astro-55HNOTDJ">Onemanager</a>&nbsp;|&nbsp;
        Under AGPL-3.0
    </p>
    <p class="astro-55HNOTDJ">
        <a href="https://github.com/kobe-koto/Onemanager-Theme-Charo" class="astro-55HNOTDJ">Theme Charo</a>
        by
        <a href="https://github.com/kobe-koto" class="astro-55HNOTDJ">kobe-koto</a>
        , And INJU.
    </p>
</div>
	</body>
	
	<!-- 文件上传相关 -->
    <script>
        <!--UploadJsStart-->
    function size_format(num) {
        if (num>1024) {
            num=num/1024;
        } else {
            return num.toFixed(2) + ' B';
        }
        if (num>1024) {
            num=num/1024;
        } else {
            return num.toFixed(2) + ' KB';
        }
        if (num>1024) {
            num=num/1024;
        } else {
            return num.toFixed(2) + ' MB';
        }
        return num.toFixed(2) + ' GB';
    }
    function seconds2hour(seconds) {
        let h, m, s;
        if (parseFloat(seconds)<60) {
            return seconds + 's';
        } else {
            s = (seconds % 60).toFixed(0);
            m = parseInt(seconds / 60);
            if (parseInt(m)<60) {
                return m + 'm' + s + 's';
            } else {
                h = parseInt(m / 60);
                m = m % 60;
                return h + 'h' + m + 'm' + s + 's';
            }
        }
    }
    function uploadbuttonhide() {
        document.getElementById('upload_btns').style.display='none';
        /*document.getElementById('upload_submit').disabled='disabled';
        document.getElementById('upload_file').disabled='disabled';
        document.getElementById('upload_submit').style.display='none';
        document.getElementById('upload_file').style.display='none';*/
    }
    function uploadbuttonshow() {
        document.getElementById('upload_btns').style.display='';
        /*document.getElementById('upload_file').disabled='';
        document.getElementById('upload_submit').disabled='';
        document.getElementById('upload_submit').style.display='';
        document.getElementById('upload_file').style.display='';*/
    }
    var uploading = new Object();
<!--UploadJsEnd-->
<!--OnedriveUploadJsStart-->
    function preup() {
        uploadbuttonhide();
        var files=document.getElementById('upload_file').files;
	    if (files.length<1) {
            uploadbuttonshow();
            return;
        };
        var table1=document.createElement('table');
        document.getElementById('upload_div').appendChild(table1);
        table1.setAttribute('class','list-table');
        var timea=new Date().getTime();
        var i=0;
        var uploadList = setInterval(function(){
            if (i<files.length) {
                if (Object.keys(uploading).length<5) {
                    getuplink(i);
                    i++;
                }// else console.log(Object.keys(uploading).length);
            } else clearInterval(uploadList);
        }, 1000);
        //getuplink(i);
        function getuplink(i, r=0) {
            var file=files[i];
            var td1;
            var td2;
            if (r==0) {
                var tr1=document.createElement('tr');
                table1.appendChild(tr1);
                tr1.setAttribute('data-to',1);
                td1=document.createElement('td');
                tr1.appendChild(td1);
                td1.setAttribute('style','width:30%;word-break:break-word;');
                td1.setAttribute('id','upfile_td1_'+timea+'_'+i);
                td1.innerHTML=(file.webkitRelativePath||file.name)+'<br>'+size_format(file.size)+' ('+(i+1)+'/'+files.length+')';
                td2=document.createElement('td');
                tr1.appendChild(td2);
                td2.setAttribute('id','upfile_td2_'+timea+'_'+i);
            }
            var tdnum = timea+'_'+i;
            td1=document.getElementById('upfile_td1_'+tdnum);
            td2=document.getElementById('upfile_td2_'+tdnum);
            if (file.size>100*1024*1024*1024) {
                td2.innerHTML='<font color="red"><!--constStr@UpFileTooLarge--></font>';
                uploadbuttonshow();
                return;
            }
            var upbigfilename = encodeURIComponent((file.webkitRelativePath||file.name));
            uploading[upbigfilename] = i;
            var filemd5='';
<!--GuestStart-->
            function getext(str) {
                strarry=str.split('.');
                if (strarry.length==1) return '';
                ext=strarry[strarry.length-1].toLowerCase();
                var reg = new RegExp(".","g");
                var a = str.replace(reg,"");
                if (a == ext) ext = "";
                else ext = "." + ext;
                return ext;
            }
        var ext = getext(file.webkitRelativePath||file.name);
        var spark = new SparkMD5.ArrayBuffer();
        var reader = new FileReader();
        var chunksize=10*1024*1024;
        var asize = 0;
        function readblob(start) {
            var end=start+chunksize;
            var blob = file.slice(start,end);
            reader.readAsArrayBuffer(blob);
        }
        readblob(asize);

        reader.onload = function(e){
            td2.innerHTML='<!--constStr@Calculate--> md5: '+(asize*100/file.size).toFixed(2)+'%';
            var binary = this.result;
            spark.append(binary);
            asize += chunksize;
            if (asize < file.size) {
                readblob(asize);
            } else {
                filemd5 = spark.end();
                td2.innerHTML='md5: '+filemd5;
                delete uploading[upbigfilename];
                upbigfilename = filemd5+ext;
                uploading[upbigfilename] = i;
<!--GuestEnd-->
            td2.innerHTML='<!--constStr@GetUploadLink--> ...';
            var xhr1 = new XMLHttpRequest();
            xhr1.open("POST", '?action=upbigfile');
            //xhr1.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
            xhr1.setRequestHeader('x-requested-with','XMLHttpRequest');
            xhr1.onprogress = function(e){
                td2.innerHTML+='.';
            }
            xhr1.onload = function(e){
                //console.log(xhr1.status+xhr1.responseText);
                td2.innerHTML='<font color="red">'+xhr1.responseText+'</font>';
                if (xhr1.status==200) {
                    if (xhr1.responseText=='') {
                        getuplink(i,1);
                        return;
                    }
                    var html=JSON.parse(xhr1.responseText);
                    if (!html['uploadUrl']) {
                        td2.innerHTML='<font color="red">'+xhr1.responseText+'</font><br>';
                    } else {
                        td2.innerHTML='<!--constStr@UploadStart--> ...';
                        binupfile(file,html['uploadUrl'],timea+'_'+i, upbigfilename);
                    }
                } else {
                    if (xhr1.status==409) {
                        // td2.innerHTML='nameAlreadyExists';
                        var html=JSON.parse(xhr1.responseText);
                        td2.innerHTML=html['error']['code']+': '+html['error']['message'];
<!--GuestStart-->
                        td2.innerHTML='md5: '+filemd5;
                        td1.innerHTML='<div><a href="<!--base_disk_path--><!--Path-->'+upbigfilename+'?preview" id="upfile_a_'+tdnum+'" target="_blank">'+td1.innerHTML+'</a><br><a href="<!--base_disk_path--><!--Path-->'+upbigfilename+'" id="upfile_a1_'+tdnum+'"></a><!--constStr@UploadComplete--><button onclick="CopyAllDownloadUrl(\'#upfile_a1_'+tdnum+'\');" id="upfile_cpbt_'+tdnum+'"><!--constStr@CopyUrl--></button></div>';
<!--GuestEnd-->
                    }
                /*if (i<files.length-1) {
                    i++;
                    getuplink(i);
                }*/
                    delete uploading[upbigfilename];
                }
            }
            xhr1.send('upbigfilename='+ upbigfilename +'&filesize='+ file.size +'&filelastModified='+ file.lastModified +'&filemd5='+ filemd5 + '&_admin=' + localStorage.getItem("admin"));
<!--GuestStart-->
            }
        }
<!--GuestEnd-->
        }
        uploadbuttonshow();
    }

    function binupfile(file,url,tdnum,filename){
        var label=document.getElementById('upfile_td2_'+tdnum);
        var reader = new FileReader();
        var StartStr='';
        var MiddleStr='';
        var StartTime;
        var EndTime;
        var newstartsize = 0;
        if(!!file){
            var asize=0;
            var chunksize=10*1024*1024; // chunk size, max 60M. 每小块上传大小，最大60M，微软建议10M
            var totalsize=file.size;
            var xhr2 = new XMLHttpRequest();
            xhr2.open("GET", url);
                    //xhr2.setRequestHeader('x-requested-with','XMLHttpRequest');
            xhr2.send(null);
            xhr2.onload = function(e){
                if (xhr2.status==200) {
                    var html = JSON.parse(xhr2.responseText);
                    var a = html['nextExpectedRanges'][0];
                    newstartsize = Number( a.slice(0,a.indexOf("-")) );
                    StartTime = new Date();
                    asize = newstartsize;
                    if (newstartsize==0) {
                        StartStr='<!--constStr@UploadStartAt-->:' +StartTime.toLocaleString()+'<br>' ;
                    } else {
                        StartStr='<!--constStr@LastUpload-->'+size_format(newstartsize)+ '<br><!--constStr@ThisTime--><!--constStr@UploadStartAt-->:' +StartTime.toLocaleString()+'<br>' ;
                    }
                    function readblob(start) {
                        var end=start+chunksize;
                        var blob = file.slice(start,end);
                        reader.readAsArrayBuffer(blob);
                    }
                    readblob(asize);

                    reader.onload = function(e){
                        var binary = this.result;
                        var lastCurrentSpeed;
                        var xhr = new XMLHttpRequest();
                        xhr.open("PUT", url, true);
                        //xhr.setRequestHeader('x-requested-with','XMLHttpRequest');
                        bsize=asize+e.loaded-1;
                        xhr.setRequestHeader('Content-Range', 'bytes ' + asize + '-' + bsize +'/'+ totalsize);
                        xhr.upload.onprogress = function(e){
                            if (e.lengthComputable) {
                                let tmptime = new Date();
                                let tmpspeed = e.loaded*1000/(tmptime.getTime()-C_starttime.getTime());
                                lastCurrentSpeed = tmpspeed;
                                let remaintime = (totalsize-asize-e.loaded)/tmpspeed;
                                let percent = ((asize+e.loaded)*100/totalsize).toFixed(2);
                                label.parentNode.style.background = "linear-gradient(to right, rgba(0,0,0,25%) " + percent + "%, rgba(0,0,0,0%) 0%)";
                                label.innerHTML = StartStr+'<!--constStr@Upload--> ' +size_format(asize+e.loaded)+ ' / '+size_format(totalsize) + ' = ' + percent + '% <!--constStr@AverageSpeed-->:'+size_format((asize+e.loaded-newstartsize)*1000/(tmptime.getTime()-StartTime.getTime()))+'/s<br><!--constStr@CurrentSpeed--> '+size_format(tmpspeed)+'/s <!--constStr@Expect--> '+seconds2hour(remaintime.toFixed(1));
                            }
                        }
                        var C_starttime = new Date();
                        xhr.onload = function(e){
                            if (xhr.status<500) {
                            var response=JSON.parse(xhr.responseText);
                            if (response['size']>0) {
                                // contain size, upload finish. 有size说明是最终返回，上传结束
                                if (totalsize>10*1024*1024) {
                                    var xhr3 = new XMLHttpRequest();
                                    xhr3.open("GET", '?action=del_upload_cache&filelastModified='+file.lastModified+'&filesize='+file.size+'&filename='+filename);
                                    xhr3.setRequestHeader('x-requested-with','XMLHttpRequest');
                                    xhr3.send(null);
                                    xhr3.onload = function(e){
                                        console.log(xhr3.responseText+','+xhr3.status);
                                    }
                                }
                                EndTime=new Date();
                                MiddleStr = '<!--constStr@EndAt-->:'+EndTime.toLocaleString()+'<br>';
                                if (newstartsize==0) {
                                    MiddleStr += '<!--constStr@AverageSpeed-->:'+size_format(totalsize*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                                } else {
                                    MiddleStr += '<!--constStr@ThisTime--><!--constStr@AverageSpeed-->:'+size_format((totalsize-newstartsize)*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                                }
                                delete uploading[filename];
                                while (filename.indexOf('%2F')>0) filename = filename.replace('%2F', '/');
                                document.getElementById('upfile_td1_'+tdnum).innerHTML='<div><a href="<!--base_disk_path--><!--Path-->'+filename+'?preview" id="upfile_a_'+tdnum+'" target="_blank">'+document.getElementById('upfile_td1_'+tdnum).innerHTML+'</a><br><a href="<!--base_disk_path--><!--Path-->'+filename+'" id="upfile_a1_'+tdnum+'"></a><!--constStr@UploadComplete--></div>';
                                label.innerHTML=StartStr+MiddleStr;
                                label.parentNode.style.background = 'rgba(0,80,0,25%)';
                                
                                // uploadbuttonshow();
                            } else {
                                if (!response['nextExpectedRanges']) {
                                    label.innerHTML='<font color="red">'+xhr.responseText+'</font><br>';
                                    delete uploading[filename];
                                } else {
                                    var a=response['nextExpectedRanges'][0];
                                    asize=Number( a.slice(0,a.indexOf("-")) );
                                    chunksize = 10*1024*1024;
                                    if (lastCurrentSpeed>5*1024*1024) chunksize = 20*1024*1024;
                                    if (lastCurrentSpeed>10*1024*1024) chunksize = 50*1024*1024;
                                    readblob(asize);
                                }
                            } } else readblob(asize);
                        }
                        xhr.send(binary);
                    }
                } else {
                    if (window.location.pathname.indexOf('%23')>0||filename.indexOf('%23')>0) {
                        label.innerHTML='<font color="red"><!--constStr@UploadFail23--></font>';
                    } else {
                        label.innerHTML='<font color="red">'+xhr2.responseText+'</font>';
                    }
                    delete uploading[filename];
                    // uploadbuttonshow();
                }
            }
        }
    }
<!--OnedriveUploadJsEnd-->
<!--AliyundriveUploadJsStart-->
    function preup() {
        uploadbuttonhide();
        var files=document.getElementById('upload_file').files;
	    if (files.length<1) {
            uploadbuttonshow();
            return;
        };
        var table1=document.createElement('table');
        document.getElementById('upload_div').appendChild(table1);
        table1.setAttribute('class','list-table');
        var timea=new Date().getTime();
        var i=0;
        var uploadList = setInterval(function(){
            if (i<files.length) {
                if (Object.keys(uploading).length<5) {
                    getuplink(i);
                    i++;
                }// else console.log(Object.keys(uploading).length);
            } else clearInterval(uploadList);
        }, 1000);
        function CalcProof(file) {
            return new Promise(function(resolve, reject){
                var xhr = new XMLHttpRequest();
                xhr.open("POST", '?action=upbigfile');
                xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
                xhr.setRequestHeader('x-requested-with', 'XMLHttpRequest');
                xhr.onload = function(e){
                    var html;
                    if (xhr.status==200) {
                        //console.log(xhr.responseText);
                        var r = new BigNumber("0x".concat(xhr.responseText));
                        var i = new BigNumber(file.size);
                        var o = i ? r.mod(i) : 0;
                        var reader1 = new FileReader();
                        var start = o.toNumber();
                        var end = start + 8;
                        //if (file.size<end) end = file.size;
                        console.log(start + " ~ " + end);
                        //reader1.readAsBinaryString(file.slice(start,end));
                        reader1.readAsDataURL(file.slice(start,end));
                        reader1.onload = function(e) {
                            var proof = this.result;
                            proof = proof.substr(proof.indexOf('base64,')+7);
                            resolve(proof);
                        }
                    } else {
                        //console.log(xhr.status+'calc proof code\n'+xhr.responseText);
                        reject(xhr.status+"\ncalc proof code\n"+xhr.responseText);
                    }
                }
                xhr.send('CalcProof=1');
            });
        }
        function getuplink(i, r=0) {
            var file=files[i];
            var td1;
            var td2;
            if (r==0) {
                var tr1=document.createElement('tr');
                table1.appendChild(tr1);
                tr1.setAttribute('data-to',1);
                td1=document.createElement('td');
                tr1.appendChild(td1);
                td1.setAttribute('style','width:30%;word-break:break-word;');
                td1.setAttribute('id','upfile_td1_'+timea+'_'+i);
                td1.innerHTML=(file.webkitRelativePath||file.name)+'<br>'+size_format(file.size)+' ('+(i+1)+'/'+files.length+')';
                td2=document.createElement('td');
                tr1.appendChild(td2);
                td2.setAttribute('id','upfile_td2_'+timea+'_'+i);
            }
            var tdnum = timea+'_'+i;
            td1=document.getElementById('upfile_td1_'+tdnum);
            td2=document.getElementById('upfile_td2_'+tdnum);
            var chunksize=10*1024*1024; // 分块大小
            //var chunksize=100*1024; // 测试小块
            /*if (file.size>100*1024*1024*1024) {
                td2.innerHTML='<font color="red"><!--constStr@UpFileTooLarge--></font>';
                uploadbuttonshow();
                return;
            }*/
            
            var upbigfilename = encodeURIComponent((file.webkitRelativePath||file.name));
            uploading[upbigfilename] = [i];
            var spark = sha1.create();
            var reader = new FileReader();
            var asize = 0;
            var filesha1;
            function readblob(start) {
                var end=start+chunksize;
                var blob = file.slice(start,end);
                reader.readAsArrayBuffer(blob);
            }
            var proof_code = '';
            CalcProof(file).then(a => {
                proof_code = a;
                console.log('proof: ' + proof_code);
                readblob(asize);
            }, e => {
                td2.innerHTML = e;
            });

            reader.onload = function(e){
                td2.innerHTML='<!--constStr@Calculate--> SHA1: '+(asize*100/file.size).toFixed(2)+'%';
                var binary = this.result;
                spark.update(binary);
                asize += chunksize;
                if (asize < file.size) {
                    readblob(asize);
                } else {
                    filesha1 = spark.hex();
                    td2.innerHTML='SHA1: ' + filesha1;
<!--GuestStart-->
                    function getext(str) {
                        let p = str.lastIndexOf('.');
                        if (p===-1) return '';
                        if (p===0) return '';
                        return str.substr(p);
                    }
                    var ext = getext(file.webkitRelativePath||file.name);
                    upbigfilename = filesha1 + ext;
<!--GuestEnd-->
                    //while (upbigfilename.indexOf('%2F')>0) upbigfilename = upbigfilename.replace('%2F', '/');
                    td2.innerHTML='<!--constStr@GetUploadLink--> ...';
                    var html = JSON.parse(localStorage.getItem(filesha1));
                    //console.log(html);
                    if (html!==null && ('part_info_list' in html)) {
                        td2.innerHTML='<!--constStr@UploadStart--> ...';
                        binupfile(file, html, timea+'_'+i, upbigfilename, filesha1, chunksize);
                    } else {
                        var xhr1 = new XMLHttpRequest();
                        xhr1.open("POST", '?action=upbigfile');
                        //xhr1.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
                        xhr1.setRequestHeader('x-requested-with','XMLHttpRequest');
                        xhr1.onload = function(e){
                            //console.log(xhr1.status+xhr1.responseText);
                            td2.innerHTML='<font color="red">'+xhr1.responseText+'</font>';
                            if (xhr1.status==201) {
                                if (xhr1.responseText=='') {
                                    getuplink(i,1);
                                    return;
                                }
                                var html=JSON.parse(xhr1.responseText);
                                //console.log(html);
                                if (!html['part_info_list']) {
                                    if (html.name!='') {
                                        if (html.exist==true) td2.innerHTML=html.name+' 文件名已有';
                                        else if (html.rapid_upload==true) td2.innerHTML=html.name+' 秒传';
                                        else td2.innerHTML='<font color="red">'+xhr1.responseText+'</font><br>';
                                        td1.innerHTML='<div><a href="<!--base_disk_path--><!--Path-->'+upbigfilename+'?preview" id="upfile_a_'+tdnum+'" target="_blank">'+td1.innerHTML+'</a><br><a href="<!--base_disk_path--><!--Path-->'+upbigfilename+'" id="upfile_a1_'+tdnum+'"></a><!--constStr@UploadComplete--><button onclick="CopyAllDownloadUrl(\'#upfile_a1_'+tdnum+'\');" id="upfile_cpbt_'+tdnum+'"  ><!--constStr@CopyUrl--></button></div>';
                                    } else {
                                        td2.innerHTML='<font color="red">'+xhr1.responseText+'</font><br>';
                                    }
                                    delete uploading[upbigfilename];
                                } else {
                                    td2.innerHTML='<!--constStr@UploadStart--> ...';
                                    //console.log(html);
                                    localStorage.setItem(filesha1, JSON.stringify(html));
                                    binupfile(file, html, timea+'_'+i, upbigfilename, filesha1, chunksize);
                                }
                            } else {
                                delete uploading[upbigfilename];
                            }
                            /*if (i<files.length-1) {
                                i++;
                                getuplink(i);
                            }*/
                        }
                        xhr1.send('upbigfilename='+ upbigfilename +'&filesize='+ file.size +'&filelastModified='+ file.lastModified + '&proof_code=' + proof_code + '&filesha1=' + filesha1 + '&chunksize=' + chunksize + '&_admin=' + localStorage.getItem("admin"));
                    }
                }
            }
        }
        uploadbuttonshow();
    }
    function binupfile(file, res, tdnum, filename, filesha1, chunksize) {
        // xhr.getResponseHeader
        if (!('ETag' in res)) res['ETag'] = new Array();
        var fileid = res['file_id'];
        var uploadid = res['upload_id'];
        var label=document.getElementById('upfile_td2_'+tdnum);
        var reader = new FileReader();
        var StartStr='';
        var MiddleStr='';
        var StartTime;
        var EndTime;
        var newstartsize = 0;
        if(!!file){
            var chunknum = 0;
            var chunknumtotal = res['part_info_list'].length;
            var asize=0;
            var totalsize=file.size;
            var newstartsize=0;
            while (res['ETag'][chunknum]!=null) {
                chunknum++;
                newstartsize += chunksize;
            }
            StartTime = new Date();
            asize = newstartsize;
            if (newstartsize==0) {
                StartStr='<!--constStr@UploadStartAt-->:' +StartTime.toLocaleString()+'<br>' ;
            } else {
                StartStr='<!--constStr@LastUpload-->'+size_format(newstartsize)+ '<br><!--constStr@ThisTime--><!--constStr@UploadStartAt-->:' +StartTime.toLocaleString()+'<br>' ;
            }
            //var chunksize=5*1024*1024; // chunk size, max 60M. 每小块上传大小
            //if (totalsize>200*1024*1024) chunksize=10*1024*1024;
            function readblob(start) {
                var end=start+chunksize;
                var blob = file.slice(start,end);
                reader.readAsArrayBuffer(blob);
                //reader.readAsArrayBuffer(file);
            }
            readblob(asize);

            reader.onload = function(e){
                if (asize>totalsize) {
                    var xhr1 = new XMLHttpRequest();
                    xhr1.open("POST", '?action=upbigfile');
                    //xhr1.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
                    xhr1.setRequestHeader('x-requested-with','XMLHttpRequest');
                    xhr1.onload = function(e){
                        console.log(xhr1.responseText+','+xhr1.status);
                        if (xhr1.status==200) {
                            localStorage.removeItem(filesha1);
                            /*if (totalsize>10*1024*1024) {
                                var xhr3 = new XMLHttpRequest();
                                xhr3.open("GET", '?action=del_upload_cache&filelastModified='+file.lastModified+'&filesize='+file.size+'&filename='+filename);
                                xhr3.setRequestHeader('x-requested-with','XMLHttpRequest');
                                xhr3.send(null);
                                xhr3.onload = function(e){
                                    console.log(xhr3.responseText+','+xhr3.status);
                                }
                            }*/
                            EndTime=new Date();
                            MiddleStr = '<!--constStr@EndAt-->:'+EndTime.toLocaleString()+'<br>';
                            if (newstartsize==0) {
                                MiddleStr += '<!--constStr@AverageSpeed-->:'+size_format(totalsize*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                            } else {
                                MiddleStr += '<!--constStr@ThisTime--><!--constStr@AverageSpeed-->:'+size_format((totalsize-newstartsize)*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                            }
                            document.getElementById('upfile_td1_'+tdnum).innerHTML='<div><a href="<!--base_disk_path--><!--Path-->'+filename+'?preview" id="upfile_a_'+tdnum+'" target="_blank">'+document.getElementById('upfile_td1_'+tdnum).innerHTML+'</a><br><a href="<!--base_disk_path--><!--Path-->'+filename+'" id="upfile_a1_'+tdnum+'"></a><!--constStr@UploadComplete--><button onclick="CopyAllDownloadUrl(\'#upfile_a1_'+tdnum+'\');" id="upfile_cpbt_'+tdnum+'"><!--constStr@CopyUrl--></button></div>';
                            label.innerHTML=StartStr+MiddleStr;
                            label.parentNode.style.background = 'rgba(0,80,0,25%)';
                        } else {
                            label.innerHTML= '<font color="red">' + xhr1.status + ',' + xhr1.responseText + '</font>';
                            localStorage.removeItem(filesha1);
                        }
                        delete uploading[filename];
                    }
                    xhr1.send('uploadid=' + uploadid + '&fileid=' + fileid + '&etag=' + JSON.stringify(res['ETag']) + '&_admin=' + localStorage.getItem("admin"));
                } else {
                    var binary = this.result;
                    var xhr = new XMLHttpRequest();
                    xhr.open("PUT", res['part_info_list'][chunknum]['upload_url'], true);
                    //xhr.setRequestHeader('x-requested-with','XMLHttpRequest');
                    bsize=asize+e.loaded-1;
                    xhr.setRequestHeader('Content-Range', 'bytes ' + asize + '-' + bsize +'/'+ totalsize);
                    xhr.upload.onprogress = function(e){
                        if (e.lengthComputable) {
                            var tmptime = new Date();
                            var tmpspeed = e.loaded*1000/(tmptime.getTime()-C_starttime.getTime());
                            var remaintime = (totalsize-asize-e.loaded)/tmpspeed;
                            let percent = ((asize+e.loaded)*100/totalsize).toFixed(2);
                            label.parentNode.style.background = "linear-gradient(to right, rgba(0,0,0,25%) " + percent + "%, rgba(0,0,0,0%) 0%)";
                            label.innerHTML=StartStr+'<!--constStr@Upload--> ' +size_format(asize+e.loaded)+ ' / '+size_format(totalsize) + ' = ' + percent + '% <!--constStr@AverageSpeed-->:'+size_format((asize+e.loaded-newstartsize)*1000/(tmptime.getTime()-StartTime.getTime()))+'/s<br><!--constStr@CurrentSpeed--> '+size_format(tmpspeed)+'/s <!--constStr@Expect--> '+seconds2hour(remaintime.toFixed(1));
                        }
                    }
                    var C_starttime = new Date();
                    xhr.onload = function(e){
                        if (xhr.status<500) {
                            //console.log(xhr.responseText);
                            //console.log(xhr.getResponseHeader('ETag'));
                        //var response=JSON.parse(xhr.responseText);
                        if (xhr.responseText==''&&xhr.getResponseHeader('ETag')!='') {
                            // 有ETag说明本段上传成功
                            let etag = xhr.getResponseHeader('ETag');
                            //if (etag.substr(0,1)=='"') etag = etag.substr(1);还就要引号！
                            //if (etag.substr(-1)=='"') etag = etag.substr(0, etag.length-1);
                            res['ETag'][chunknum] = etag;
                            localStorage.setItem(filesha1, JSON.stringify(res));
                            chunknum++;
                            asize = bsize + 1;
                            if (chunknum==chunknumtotal) {
                                // 上传结束
                                var xhr1 = new XMLHttpRequest();
                                xhr1.open("POST", '?action=upbigfile');
                                //xhr1.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
                                xhr1.setRequestHeader('x-requested-with','XMLHttpRequest');
                                xhr1.onload = function(e){
                                    console.log(xhr1.responseText+','+xhr1.status);
                                    if (xhr1.status==200) {
                                        localStorage.removeItem(filesha1);
                                        /*if (totalsize>10*1024*1024) {
                                            var xhr3 = new XMLHttpRequest();
                                            xhr3.open("GET", '?action=del_upload_cache&filelastModified='+file.lastModified+'&filesize='+file.size+'&filename='+filename);
                                            xhr3.setRequestHeader('x-requested-with','XMLHttpRequest');
                                            xhr3.send(null);
                                            xhr3.onload = function(e){
                                                console.log(xhr3.responseText+','+xhr3.status);
                                            }
                                        }*/
                                        EndTime=new Date();
                                        MiddleStr = '<!--constStr@EndAt-->:'+EndTime.toLocaleString()+'<br>';
                                        if (newstartsize==0) {
                                            MiddleStr += '<!--constStr@AverageSpeed-->:'+size_format(totalsize*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                                        } else {
                                            MiddleStr += '<!--constStr@ThisTime--><!--constStr@AverageSpeed-->:'+size_format((totalsize-newstartsize)*1000/(EndTime.getTime()-StartTime.getTime()))+'/s<br>';
                                        }
                                        document.getElementById('upfile_td1_'+tdnum).innerHTML='<div><a href="<!--base_disk_path--><!--Path-->'+filename+'?preview" id="upfile_a_'+tdnum+'" target="_blank">'+document.getElementById('upfile_td1_'+tdnum).innerHTML+'</a><br><a href="<!--base_disk_path--><!--Path-->'+filename+'" id="upfile_a1_'+tdnum+'"></a><!--constStr@UploadComplete--><button onclick="CopyAllDownloadUrl(\'#upfile_a1_'+tdnum+'\');" id="upfile_cpbt_'+tdnum+'"  ><!--constStr@CopyUrl--></button></div>';
                                        label.innerHTML=StartStr+MiddleStr;
                                        label.parentNode.style.background = 'rgba(0,80,0,25%)';
                                    } else {
                                        label.innerHTML= '<font color="red">' + xhr1.status + ',' + xhr1.responseText + '</font>';
                                        localStorage.removeItem(filesha1);
                                    }
                                    delete uploading[filename];
                                }
                                xhr1.send('uploadid=' + uploadid + '&fileid=' + fileid + '&etag=' + JSON.stringify(res['ETag']) + '&_admin=' + localStorage.getItem("admin"));
                                // uploadbuttonshow();
                            } else {
                                readblob(asize);
                            }
                        } else {
                            console.log(xhr.status+xhr.responseText);//<PartEtag>
                            if (xhr.status==409) {
                                let str = xhr.responseText;
                                str = str.substr(str.indexOf('<PartEtag>')+10);
                                str = str.substr(0, str.indexOf('</PartEtag>'));
                                res['ETag'][chunknum] = str;
                                localStorage.setItem(filesha1, JSON.stringify(res));
                                chunknum++;
                                asize += chunksize;
                                readblob(asize);
                            } else {
                                delete uploading[filename];
                            }
                                //label.innerHTML='<font color="red">'+xhr.responseText+'</font><br>';
                        } } else readblob(asize);
                    }
                    xhr.send(binary);
                }
            }
        }
    }
<!--AliyundriveUploadJsEnd-->
    </script>
	
	
	<!--customScript--></html><!--IconValuesStart--><!--

{
    "music":"musical-notes",
    "video":"logo-youtube",
    "img":"image",
    "office":"newspaper",
    "txt":"clipboard",
    "zip":"file-tray-full",
    "iso":"disc",
    "apk":"logo-android",
    "exe":"logo-windows",
    "default":"document"
}

--><!--IconValuesEnd-->
